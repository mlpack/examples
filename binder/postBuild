#!/bin/bash
set -eux

env | sort
pwd

# jupyter-offlinenotebook is automatically installed by repo2docker.
# Uninstall to avoid conflicts.
jupyter labextension uninstall --no-build jupyter-offlinenotebook

# Upgrade jupyterlab if necessary.
conda install jupyterlab=2

# Install necessary kernel and debugger related dependency following
# https://github.com/jupyterlab/debugger#installation, doing it in
# postBuild and not `environment.yml` to avoid breaking jupyter-offlinenotebook.
conda install -c conda-forge -c xeus-cling xplot xwidgets

# Install the debugger in postBuild and not `environment.yml` to
# avoid breaking jupyter-offlinenotebook.
jupyter labextension install @jupyterlab/debugger
jupyter labextension install @jupyterlab/toc
jupyter labextension install @jupyter-widgets/jupyterlab-manager
jupyter labextension install bqplot@^0.4.3

# Cleanup.
conda clean --all
